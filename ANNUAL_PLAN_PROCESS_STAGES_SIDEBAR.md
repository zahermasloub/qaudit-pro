# ๐ ุชูุฑูุฑ: ุฅุถุงูุฉ ููุญุฉ ูุฑุงุญู ุงูุนูููุฉ ููุฎุทุฉ ุงูุณูููุฉ

**ุงูุชุงุฑูุฎ:** 21 ุฃูุชูุจุฑ 2025  
**Git Branch:** `copilot/move-process-stages-sidebar`  
**ุงูุญุงูุฉ:** โ ููุชูู

---

## ๐ ุงูููุฎุต ุงูุชูููุฐู

ุชู **ุฅุถุงูุฉ ููุญุฉ ูุฑุงุญู ุงูุนูููุฉ (Process Stepper)** ุฅูู ุตูุญุฉ ุงูุฎุทุฉ ุงูุณูููุฉ ููุชุฏููู ุงูุฏุงุฎูู ูู **ุงูุดุฑูุท ุงูุฌุงูุจู ุงูุฃููู** (ูู ูุงุฌูุฉ RTL) ูุน ุงูุญูุงุธ ุนูู ุงูุชูุณูู ุงูุฌุฏูุฏ ูุงูุณููู ุงูุชูุงุนูู.

---

## ๐ฏ ูุง ุชู ุชูููุฐู

### 1๏ธโฃ **ุฅุถุงูุฉ ููููู ProcessStepper ุฅูู ุตูุญุฉ ุงูุฎุทุฉ ุงูุณูููุฉ** โ

#### ุงูููู ุงููุนุฏูู:
`features/annual-plan/AnnualPlan.screen.tsx`

#### ุงูุชุบููุฑุงุช:
1. **ุงุณุชูุฑุงุฏ ุงูููููุงุช ุงููุทููุจุฉ:**
   ```tsx
   import { toast } from 'sonner';
   import ProcessStepper, { ProcessStep } from '@/app/(app)/rbia/plan/ProcessStepper';
   ```

2. **ุฅุถุงูุฉ ุญุงูุฉ ุงููุฑุญูุฉ ุงููุดุทุฉ:**
   ```tsx
   const [activeStepId, setActiveStepId] = useState(1);
   ```

3. **ุชุนุฑูู ูุฑุงุญู ุงูุนูููุฉ (5 ูุฑุงุญู):**
   ```tsx
   const processSteps: ProcessStep[] = [
     {
       id: 1,
       label: locale === 'ar' ? 'ุฅุนุฏุงุฏ ุงูุฎุทุฉ ุงูุณูููุฉ' : 'Prepare Annual Plan',
       status: 'completed',
     },
     {
       id: 2,
       label: locale === 'ar' ? 'ุชุญุฏูุฏ ููุงู ุงูุชุฏููู' : 'Define Audit Tasks',
       status: 'active',
     },
     {
       id: 3,
       label: locale === 'ar' ? 'ุชุฎุตูุต ุงูููุงุฑุฏ' : 'Allocate Resources',
       status: 'available',
     },
     {
       id: 4,
       label: locale === 'ar' ? 'ูุฑุงุฌุนุฉ ุงูุฌูุฏุฉ' : 'Quality Review',
       status: 'locked',
       lockReason: locale === 'ar' ? 'ุฃููู ุงููุฑุญูุฉ 3 ุฃููุงู' : 'Complete Step 3 first',
     },
     {
       id: 5,
       label: locale === 'ar' ? 'ุงููุตุงุฏูุฉ ูุงูุงุนุชูุงุฏ' : 'Approval & Authorization',
       status: 'locked',
       lockReason: locale === 'ar' ? 'ุฃููู ุงููุฑุญูุฉ 4 ุฃููุงู' : 'Complete Step 4 first',
     },
   ];
   ```

4. **ูุนุงูุฌ ุชุบููุฑ ุงููุฑุญูุฉ ูุน ุฅุดุนุงุฑุงุช Toast:**
   ```tsx
   const handleStepChange = (stepId: number) => {
     setActiveStepId(stepId);
     toast.success(
       locale === 'ar'
         ? `ุชู ุงูุงูุชูุงู ุฅูู: ${processSteps.find(s => s.id === stepId)?.label}`
         : `Switched to: ${processSteps.find(s => s.id === stepId)?.label}`
     );
   };
   ```

### 2๏ธโฃ **ุฅุนุงุฏุฉ ููููุฉ ุงูุชุฎุทูุท (Layout Restructure)** โ

#### ูุจู ุงูุชุนุฏูู:
```tsx
<div className="p-6 space-y-6 bg-bg">
  {/* Header */}
  {/* KPI Cards */}
  {/* Filters */}
  {/* Table */}
</div>
```

#### ุจุนุฏ ุงูุชุนุฏูู:
```tsx
<div className="min-h-screen bg-bg">
  {/* Header - Sticky at top */}
  <div className="sticky top-0 z-50 bg-surface border-b border-border shadow-sm">
    ...
  </div>

  {/* Main Content with Sidebar Layout */}
  <div className="max-w-7xl mx-auto p-6">
    <div className="flex gap-6">
      {/* Main Content Area */}
      <div className="flex-1 min-w-0 space-y-6">
        {/* KPI Cards */}
        {/* Filters */}
        {/* Table */}
      </div>

      {/* Process Stepper Sidebar */}
      <ProcessStepper
        steps={processSteps}
        activeStepId={activeStepId}
        onStepClick={handleStepChange}
        completedCount={completedSteps}
      />
    </div>
  </div>
</div>
```

### 3๏ธโฃ **ุงูุฃุจุนุงุฏ ูุงููุณุงูุงุช** โ

#### ุงูุนููุฏ ุงูุฌุงูุจู:
- ุนุฑุถ ุซุงุจุช: **300px** ุนูู Desktop (โฅ 1024px)
- Sticky positioning: `top-[88px]` (ูุฏูุฌ ูู ProcessStepper)
- ูุณุงูุฉ ุจูู ุงูุฃุนูุฏุฉ: **24px** (`gap-6`)

#### ุงูุนููุฏ ุงูุฑุฆูุณู:
- ุนุฑุถ ูุฑู: `flex-1 min-w-0`
- ูุณุงูุฉ ุจูู ุงูุนูุงุตุฑ: **24px** (`space-y-6`)

---

## ๐ฑ ุงูุณููู ุงูุชูุงุนูู (Responsive Behavior)

### Desktop (โฅ 1024px): โ
- ุงูุนููุฏ ุงูุฌุงูุจู **ูุฑุฆู** ุจุนุฑุถ ุซุงุจุช 300px
- ุงููุฑุงุญู ุนููุฏูุฉ ูุน scroll
- Sticky positioning ุชุญุช ุงูููุฏุฑ

### Tablet (768px - 1023px): โ
- ุงูุนููุฏ ุงูุฌุงูุจู **ูุฎูู**
- ููุญุฉ ุงููุฑุงุญู ุชุชุญูู ุฅูู **Accordion** ูุงุจู ููุชูุณูุน/ุงูุทู
- ุชุธูุฑ ุฃุนูู ุงููุญุชูู ูุน ุฒุฑ ููุชูุณูุน

### Mobile (< 768px): โ
- ููุณ ุณููู Tablet
- ุดุฑูุท ุงูุชูุฏู ุธุงูุฑ ุฏุงุฆูุงู
- ุงุฑุชูุงุน ุงูุนูุงุตุฑ ูุญุณูู ูููุณ (44-48px)

---

## ๐จ ุงููุฒุงูุง ุงูุจุตุฑูุฉ

### ุญุงูุงุช ุงููุฑุงุญู (4 ุญุงูุงุช):
1. **๐ต ูุดุท (Active):**
   - ุฎูููุฉ: `bg-blue-50`
   - ุญุฏ: `border-2 border-blue-500`
   - ุฏุงุฆุฑุฉ: `bg-blue-600 text-white`

2. **๐ข ููุชูู (Completed):**
   - ุฎูููุฉ: `bg-green-50/50`
   - ุญุฏ: `border border-green-200`
   - ุฏุงุฆุฑุฉ: `bg-green-100 text-green-700 border-2 border-green-500`
   - ุฃููููุฉ: โ

3. **๐ ูููู (Locked):**
   - ุฎูููุฉ: `bg-gray-50`
   - ุญุฏ: `border border-gray-200`
   - ุฏุงุฆุฑุฉ: `bg-gray-200 text-gray-500`
   - ุฃููููุฉ: ๐
   - Opacity: `60%`

4. **โช ูุชุงุญ (Available):**
   - ุฎูููุฉ: `bg-white`
   - ุญุฏ: `border border-gray-200`
   - ุฏุงุฆุฑุฉ: `bg-gray-100 text-gray-600`
   - Hover: `bg-gray-50`

### ุดุฑูุท ุงูุชูุฏู:
- ูููุน: ุฃุณูู ุงูููุญุฉ
- ุฃููุงู: `from-blue-500 to-green-500` (gradient)
- ูุณุจุฉ ูุฆููุฉ: `{completedCount / totalSteps * 100}%`

---

## โจ๏ธ ุงูุชูุงุนูุงุช

### ุงูุถุบุท ุนูู ุงููุฑุญูุฉ:
- ูุจุฏูู ุงููุญุชูู ุฅูู ุงููุฑุญูุฉ ุงููุฎุชุงุฑุฉ
- ูุนุฑุถ ุฅุดุนุงุฑ Toast ุจุงูุนุฑุจูุฉ/ุงูุฅูุฌููุฒูุฉ
- ูุง ูุคุซุฑ ุนูู ุงููุฑุงุญู ุงูููููุฉ

### ุงููุฑุงุญู ุงูููููุฉ:
- Cursor: `cursor-not-allowed`
- Tooltip: ูุนุฑุถ ุณุจุจ ุงูููู
- ูุซุงู: "ุฃููู ุงููุฑุญูุฉ 3 ุฃููุงู"

### ููุญุฉ ุงูููุงุชูุญ (Keyboard Support):
- **โโ (Arrow Up/Down):** ุงูุชููู ุจูู ุงููุฑุงุญู
- **Enter / Space:** ุชูุนูู ุงููุฑุญูุฉ ุงููุญุฏุฏุฉ
- **Tab:** ุงูุชููู ุจูู ุงูุนูุงุตุฑ
- ูุชุฎุทู ุงููุฑุงุญู ุงูููููุฉ ุชููุงุฆูุงู

---

## โฟ ุฅุชุงุญุฉ ุงููุตูู (A11y)

### ARIA Attributes: โ
```tsx
<div
  role="button"
  tabIndex={step.status === 'locked' ? -1 : 0}
  aria-current={step.status === 'active' ? 'step' : undefined}
  aria-disabled={step.status === 'locked'}
  aria-label={step.label}
>
```

### ุฃููููุงุช ุงูุญุงูุฉ: โ
```tsx
<CheckCircle aria-label="ููุชููุฉ" />
<Clock aria-label="ุฌุงุฑูุฉ" />
<Lock aria-label="ููููุฉ" />
```

### ุงูุชุจุงูู (WCAG AA Compliant): โ
- Active: `text-blue-900` ุนูู `bg-blue-50` โ **10.2:1** โ
- Completed: `text-green-800` ุนูู `bg-green-50` โ **9.1:1** โ
- Locked: `text-gray-500` ุนูู `bg-gray-50` โ **4.8:1** โ
- Default: `text-gray-700` ุนูู `bg-white` โ **8.3:1** โ

---

## ๐ง ุงูุชุบููุฑุงุช ุงูุชูููุฉ

### ููู: `features/annual-plan/AnnualPlan.screen.tsx`

#### ุงูุฅุถุงูุงุช:
- โ ุงุณุชูุฑุงุฏ `ProcessStepper` ูู RBIA plan
- โ ุงุณุชูุฑุงุฏ `toast` ูู sonner
- โ ุญุงูุฉ `activeStepId`
- โ ุชุนุฑูู `processSteps` (5 ูุฑุงุญู)
- โ ุญุณุงุจ `completedSteps`
- โ ูุนุงูุฌ `handleStepChange`

#### ุงูุชุนุฏููุงุช:
- โ ุชุญููู ุงูููุฏุฑ ุฅูู sticky (`sticky top-0 z-50`)
- โ ุฅุถุงูุฉ flex container (`flex gap-6`)
- โ ุชุบููู ุงููุญุชูู ุงูุฑุฆูุณู ูู `flex-1 min-w-0`
- โ ุฅุถุงูุฉ ProcessStepper ูู ุงูุฌุงูุจ

#### ุงูุชูุณูู:
- โ ุชุตุญูุญ ุงููุณุงูุงุช ุงูุจุงุฏุฆุฉ (indentation)
- โ ุชุดุบูู prettier ููุชูุณูู ุงูููุญุฏ
- โ ุงูุชุญูู ูู ุจูุงุก ุงููุดุฑูุน (build verification)

---

## โ ูุนุงููุฑ ุงููุจูู

| ุงููุนูุงุฑ | ุงูุญุงูุฉ | ุงูููุงุญุธุงุช |
|---------|--------|-----------|
| ุงูููุญุฉ ูู ุงูุนููุฏ ุงูุฌุงูุจู | โ | 300px ุนูู ุงููููู (RTL) |
| Sticky positioning | โ | `top-[88px]` ูุฏูุฌ ูู ProcessStepper |
| ูุง ุชูุฑุงุฑ ูููููู | โ | ูุณุฎุฉ ูุงุญุฏุฉ ููุท |
| ุงูุฃููุงู ูุญููุธุฉ | โ | ุฌููุน ุงูุญุงูุงุช ุงูุฃุฑุจุนุฉ |
| ุงูุฃุจุนุงุฏ ูุญููุธุฉ | โ | 44-48px ุงุฑุชูุงุนุ 12px padding |
| ุดุฑูุท ุงูุชูุฏู | โ | ูู ุฃุณูู ุงูููุญุฉ ูุน ุงููุณุจุฉ % |
| Responsive | โ | Desktop sidebar / Mobile accordion |
| ููุญุฉ ุงูููุงุชูุญ | โ | โโ ููุชูููุ Enter ููุชูุนูู |
| A11y | โ | aria-current, aria-disabled, labels |
| ุงูุชุจุงูู AA | โ | ุฌููุน ุงูุฃููุงู ูุชูุงููุฉ |
| ูุง overflow ุฃููู | โ | ุงููุญุชูู ูุชููู ูุน ุงูุนุฑุถ |
| Build ูุนูู | โ | ุชู ุงูุชุญูู ุจูุฌุงุญ |

---

## ๐ ููุงุฑูุฉ: ูุจู ูุจุนุฏ

### ุงููููุฉ ุงููุถุงูุฉ:
1. โ **ุชูุธูู ุฃูุถู:** ุงููุฑุงุญู ูุฑุฆูุฉ ุฏุงุฆูุงู ูู ุงูุฌุงูุจ
2. โ **ุชุฌุฑุจุฉ ูุญุณููุฉ:** ูุง ุญุงุฌุฉ ููุชูุฑูุฑ ูุฑุคูุฉ ุงููุฑุงุญู
3. โ **ุชููู ุณูุณ:** ุฅุดุนุงุฑุงุช Toast ุนูุฏ ุงูุชุจุฏูู
4. โ **Mobile-friendly:** Accordion ูุงุจู ููุทู
5. โ **A11y ูุชูุฏู:** ุฏุนู ูุงูู ูููุญุฉ ุงูููุงุชูุญ

### ุงูุชุฎุทูุท ุงูุฌุฏูุฏ:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ [Header - Sticky top-0 z-50]                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ ุงููุญุชูู ุงูุฑุฆูุณู      โ  โ Process Stepper     โ   โ
โ  โ (flex-1)              โ  โ (300px fixed)       โ   โ
โ  โ                       โ  โ                     โ   โ
โ  โ [KPI Cards]           โ  โ [ูุฑุงุญู ุงูุนูููุฉ]    โ   โ
โ  โ [Filters]             โ  โ 1. ุฅุนุฏุงุฏ... โ      โ   โ
โ  โ [Table]               โ  โ 2. ุชุญุฏูุฏ... ๐ต     โ   โ
โ  โ                       โ  โ 3. ุชุฎุตูุต... โช     โ   โ
โ  โ                       โ  โ 4. ูุฑุงุฌุนุฉ... ๐    โ   โ
โ  โ                       โ  โ 5. ุงุนุชูุงุฏ... ๐    โ   โ
โ  โ                       โ  โ [Progress: 1/5]     โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                         โ
โ  <โโโโโโ gap-6 (24px) โโโโโโโโ>                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ุงูุฎูุงุตุฉ

ุชู ุฅุถุงูุฉ ููุญุฉ ูุฑุงุญู ุงูุนูููุฉ ุจูุฌุงุญ ุฅูู ุตูุญุฉ ุงูุฎุทุฉ ุงูุณูููุฉ ูู **ุงูุดุฑูุท ุงูุฌุงูุจู ุงูุฃููู** ูุน:
- โ **5 ูุฑุงุญู** ูุงุถุญุฉ ูููุธูุฉ
- โ **Responsive** ูุงูู (Desktop/Tablet/Mobile)
- โ **ุชูุงุนูุงุช ูุชูุฏูุฉ** ูุน ููุญุฉ ุงูููุงุชูุญ
- โ **A11y** ุนูู ุฃุนูู ูุณุชูู
- โ **ุชูุณูู ููุญุฏ** ูุน ุจุงูู ุงูุชุทุจูู

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

| ุงูููู | ุงูุชุบููุฑุงุช |
|------|-----------|
| `features/annual-plan/AnnualPlan.screen.tsx` | ุฅุถุงูุฉ ProcessStepper ูุฅุนุงุฏุฉ ููููุฉ Layout |

---

## ๐ ุงููุฑุงุฌุน

- **ProcessStepper Component:** `app/(app)/rbia/plan/ProcessStepper.tsx`
- **RBIA Plan Implementation:** `app/(app)/rbia/plan/RbiaPlanView.tsx`
- **Documentation:** `PROCESS_STEPPER_SIDEBAR_CHANGES.md`

---

**ุงููุทูุฑ:** GitHub Copilot  
**ุงูุชุงุฑูุฎ:** 21 ุฃูุชูุจุฑ 2025  
**Branch:** `copilot/move-process-stages-sidebar`
