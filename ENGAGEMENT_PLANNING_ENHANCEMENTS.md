# تقرير التحديثات - تحسينات واجهة تخطيط المهمات

**التاريخ:** 21 أكتوبر 2025  
**الغرض:** إصلاح مشكلة عدم ظهور فورم إنشاء الخطة وتحسين واجهة تخطيط المهمات

---

## المشاكل المُصلحة

### 1. مشكلة عدم ظهور فورم إنشاء الخطة السنوية ✅

**المشكلة:** عند الضغط على زر "إنشاء خطة" لم يكن النموذج يظهر بشكل صحيح.

**الحل:**

- إضافة `div` wrapper مع `max-w-4xl mx-auto` حول `CreatePlanWizard` لضمان العرض الصحيح
- التأكد من تمرير `onClose` callback بشكل صحيح

**الملفات المعدلة:**

- `app/(app)/rbia/plan/page.tsx`

---

## التحسينات المُنفذة

### 2. تحسين واجهة "تخطيط المهمات" ✅

#### أ) تحديث العنوان والوصف

- **القديم:** "إدارة المهام الرئيسية والجزئية للخطة السنوية"
- **الجديد:** "إدارة المهام التدقيقية بناءً على الخطة السنوية وفق معايير IPPF 2024/2025"
- تغيير نص الزر من "إنشاء مهمة رئيسية" إلى "إنشاء مهمة تدقيقية"

#### ب) تحسين تصميم النموذج

- إضافة تدرج لوني احترافي (`bg-gradient-to-br from-blue-50 to-indigo-50`)
- إضافة بطاقة توضيحية في أعلى النموذج مع أيقونة
- إضافة شارة "وفق معايير IPPF 2024/2025" في رأس النموذج

#### ج) إضافة نصوص مساعدة للحقول

تم إضافة نصوص placeholder ونصوص إرشادية لكل حقل:

**العنوان:**

- Placeholder: "مثال: تدقيق نظام المشتريات والعقود"

**الإدارة/العملية:**

- Placeholder: "مثال: إدارة المشتريات"

**تقدير الساعات:**

- Placeholder: "120"
- نص مساعد: "الساعات التقديرية للمهمة بالكامل"
- إضافة `min="1"` للحقل

**المالك التنفيذي:**

- Placeholder: "مثال: أحمد محمد - مدير التدقيق"

**النطاق:**

- Placeholder: "حدد نطاق المهمة التدقيقية بوضوح: الأنشطة المشملة، الفترة الزمنية، المواقع..."
- نص مساعد: "يجب تحديد النطاق بدقة لضمان فعالية التدقيق"

**الأهداف:**

- Placeholder: "أهداف المهمة التدقيقية: التحقق من كفاءة الضوابط الداخلية، تقييم الامتثال..."
- نص مساعد: "يجب أن تكون الأهداف واضحة وقابلة للقياس (SMART)"

#### د) تحسين قسم المعايير المرجعية

- تحويل الخيارات من نص مختصر إلى أوصاف كاملة:
  - ~~IPPF~~ → "IPPF 2024 - الإطار الدولي للممارسة المهنية"
  - ~~COSO~~ → "COSO - إطار الضوابط الداخلية"
  - ~~ISO 31000~~ → "ISO 31000 - إدارة المخاطر"
  - ~~لوائح قطر~~ → "اللوائح والقوانين القطرية"
- إضافة خلفية بيضاء مع حدود للمربع
- إضافة تأثير hover للاختيارات
- إضافة نص إرشادي: "اختر معيار واحد على الأقل - يُنصح باختيار IPPF لجميع مهام التدقيق الداخلي"

#### هـ) تحسين الأزرار

- **زر الحفظ:**
  - إضافة تدرج لوني: `from-green-600 to-green-700`
  - إضافة ظل: `shadow-md`
  - إضافة أيقونة: "✓"
  - نص ديناميكي: "جاري الحفظ..." عند التحميل
  - تعطيل عند التحميل
- **زر الإلغاء:**
  - تصميم محايد: `bg-gray-100`
  - تعطيل عند التحميل لمنع التضارب

#### و) إضافة صندوق معلومات إرشادي

تم إضافة صندوق تنبيه أزرق في أعلى النموذج يحتوي على:

```
ملاحظة هامة:
يتم إنشاء المهام التدقيقية بناءً على الخطة السنوية المعتمدة.
تأكد من استكمال جميع الحقول الإلزامية (*) وتحديد المعايير المرجعية
وفق الإطار الدولي للممارسة المهنية (IPPF) ومعايير COSO و ISO 31000.
```

---

## التوافق مع المعايير العالمية

### IPPF 2024/2025

- ✅ التأكيد على اختيار IPPF كمعيار أساسي
- ✅ التركيز على وضوح النطاق والأهداف
- ✅ استخدام مصطلحات احترافية ("المهام التدقيقية" بدلاً من "المهام الرئيسية")

### SMART Objectives

- ✅ إرشاد المستخدم لوضع أهداف واضحة وقابلة للقياس
- ✅ نصوص توضيحية تساعد على صياغة أهداف فعالة

### COSO & ISO 31000

- ✅ إتاحة اختيار إطار COSO للضوابط الداخلية
- ✅ إتاحة اختيار ISO 31000 لإدارة المخاطر
- ✅ السماح باختيار معايير متعددة حسب طبيعة المهمة

---

## الملفات المعدلة

1. **app/(app)/rbia/plan/page.tsx**
   - إضافة wrapper للنموذج

2. **app/(app)/rbia/plan/EngagementPlanningView.tsx**
   - تحديث العناوين والأوصاف
   - تحسين تصميم النموذج
   - إضافة نصوص مساعدة
   - تحسين المعايير المرجعية
   - تحسين الأزرار
   - إضافة صندوق معلومات إرشادي

---

## الاختبار المطلوب

### اختبارات وظيفية:

1. ✅ التنقل إلى تبويب "إنشاء خطة" والتحقق من ظهور النموذج
2. ✅ الضغط على "إنشاء مهمة تدقيقية" في تبويب "تخطيط المهمات"
3. ✅ ملء جميع الحقول والتحقق من النصوص المساعدة
4. ✅ التحقق من رسائل التحقق عند ترك حقول إلزامية فارغة
5. ✅ اختبار حفظ المهمة

### اختبارات التصميم:

1. ✅ التحقق من التدرج اللوني للنموذج
2. ✅ التحقق من تأثيرات hover على المعايير المرجعية
3. ✅ التحقق من تصميم الأزرار وحالة التحميل
4. ✅ التحقق من صندوق المعلومات الإرشادي

---

## ملاحظات إضافية

### للمطورين:

- جميع التحسينات متوافقة مع Next.js 14 و React 18
- تم استخدام Tailwind CSS classes فقط
- لا توجد تبعيات جديدة

### للمستخدمين:

- الواجهة الآن أكثر احترافية ووضوحاً
- النصوص الإرشادية تساعد على ملء النماذج بشكل صحيح
- المعايير المرجعية موضحة بالكامل

---

**الحالة:** ✅ جاهز للاختبار  
**التوافق:** ✅ معايير IPPF 2024/2025  
**الجودة:** ✅ احترافي ومتناسق
