# ๐๏ธ ุชูุฑูุฑ ุญุฐู ุตูุญุฉ ุงูุฎุทุฉ ุงูุณูููุฉ ุงููุฏููุฉ

**ุงูุชุงุฑูุฎ:** 2025-10-20  
**ุงูุญุงูุฉ:** โ ุชู ุงูุญุฐู ุจูุฌุงุญ  
**ุงูุณุจุจ:** ุงุณุชุจุฏุงู ุงูุฎุทุฉ ุงููุฏููุฉ ุจุงูุฎุทุฉ ุงูุฌุฏูุฏุฉ RBIA

---

## ๐ **ูุธุฑุฉ ุนุงูุฉ**

ุชู ุญุฐู ุฌููุน ุนูุงุตุฑ ุตูุญุฉ ุงูุฎุทุฉ ุงูุณูููุฉ ุงููุฏููุฉ (`annualPlan`) ูู ุงููุธุงู ุจุดูู ูุงููุ ูุน ุงูุฅุจูุงุก ููุท ุนูู ุงูุฎุทุฉ ุงูุฌุฏูุฏุฉ RBIA (`rbiaplan`) ุงูุชู ุชุญุชูู ุนูู ุฌููุน ุงูููุฒุงุช ุงููุชูุฏูุฉ.

---

## โ **ุงูุนูุงุตุฑ ุงููุญุฐููุฉ**

### **1. ูู `app/(app)/shell/AppShell.tsx`:**

#### **ุฃ. Type Route:**
```typescript
// โ ุชู ุงูุญุฐู
| 'annualPlan'
```

#### **ุจ. RBAC Permissions:**
```typescript
// โ ุชู ุงูุญุฐู
annualPlan: ['IA_Manager', 'IA_Lead', 'IA_Auditor'],
```

#### **ุฌ. TOOLBARS Actions:**
```typescript
// โ ุชู ุงูุญุฐู
annualPlan: [
  { action: 'createAnnualPlan', roles: ['IA_Manager', 'IA_Lead'], variant: 'primary' },
  { action: 'addAuditTask', roles: ['IA_Manager', 'IA_Lead', 'IA_Auditor'] },
  { action: 'importCSV', roles: ['IA_Manager', 'IA_Lead', 'IA_Auditor'] },
  { action: 'exportCSV', roles: ['IA_Manager', 'IA_Lead', 'IA_Auditor'] },
],
```

#### **ุฏ. MENU_SPEC Item:**
```typescript
// โ ุชู ุงูุญุฐู
{ key: 'annualPlan', icon: ClipboardList },
```

#### **ูู. Imports:**
```typescript
// โ ุชู ุงูุญุฐู
import AnnualPlanForm from '@/features/annual-plan/annual-plan.form';
import { AnnualPlanScreen, ... } from './ScreenComponents';
```

#### **ู. Rendering Case:**
```typescript
// โ ุชู ุงูุญุฐู
{route === 'annualPlan' && <AnnualPlanScreen locale={locale} />}
```

#### **ุฒ. State & Handlers:**
```typescript
// โ ุชู ุงูุญุฐู
const [openAnnualPlan, setOpenAnnualPlan] = useState(false);

case 'createAnnualPlan':
  setOpenAnnualPlan(true);
  break;
```

#### **ุญ. Modal Component:**
```typescript
// โ ุชู ุงูุญุฐู (40+ ุณุทุฑ)
<AnnualPlanForm
  open={openAnnualPlan}
  onOpenChange={setOpenAnnualPlan}
  defaultYear={new Date().getFullYear() + 1}
  orgOptions={[...]}
  onSuccess={id => {
    console.log('โ ุชู ุญูุธ ุงูุฎุทุฉ ุงูุณูููุฉ ุจูุฌุงุญ:', id);
    setOpenAnnualPlan(false);
  }}
/>
```

---

## ๐ **ุฅุญุตุงุฆูุงุช ุงูุญุฐู**

| ุงูุนูุตุฑ | ุงูุนุฏุฏ ุงููุญุฐูู |
|--------|---------------|
| Type entries | 1 |
| RBAC entries | 1 |
| TOOLBARS entries | 1 (4 actions) |
| MENU_SPEC items | 1 |
| Import statements | 2 |
| Rendering cases | 1 |
| State variables | 1 |
| Handler cases | 1 |
| Modal components | 1 (~40 lines) |
| **ุฅุฌูุงูู ุงูุฃุณุทุฑ ุงููุญุฐููุฉ** | **~60 ุณุทุฑ** |

---

## ๐ **ุงููููุงุช ุงูุชู ูู ุชูุญุฐู (ููุณุชุจุนุฏุฉ ุนูุฏุงู)**

### **ุงููููุงุช ุงูููุฌูุฏุฉ (ููุญุฐู ูุงุญูุงู ุฅุฐุง ูุฒู ุงูุฃูุฑ):**

```
d:\THE-AUDIT-APP-2\features\annual-plan\
โโโ index.ts
โโโ AnnualPlan.screen.tsx
โโโ annual-plan.schema.ts
โโโ annual-plan.form.tsx
```

**ุงูุณุจุจ:** ูู ูุชู ุญุฐู ุงููููุงุช ุงููุนููุฉ ูู ูุฌูุฏ `features/annual-plan/` ูุฃููุง ูุฏ ุชุญุชูู ุนูู:
- Logic ูุฏ ูููู ูููุฏุงู ููุฑุฌูุน ุฅููู
- Schemas ูุฏ ุชูุณุชุฎุฏู ูู Migration
- Forms ูุฏ ุชูุนุงุฏ ุงุณุชุฎุฏุงููุง ูู ุงููุณุชูุจู

**ููุงุญุธุฉ:** ูุฐู ุงููููุงุช ุงูุขู ุบูุฑ ููุณุชุฎุฏูุฉ ูู ุงููุธุงู ููููู ุญุฐููุง ุจุงููุงูู ุฅุฐุง ูุฒู ุงูุฃูุฑ.

---

## โจ **ุงููุถุน ุงูุญุงูู ุจุนุฏ ุงูุญุฐู**

### **ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ (Sidebar) ุงูุญุงููุฉ:**

```
๐ Sidebar Menu:
โโโ ๐ ููุญุฉ ุงูููุงุฏุฉ (dashboard)
โโโ ๐ ุงูุฎุทุฉ ุงูุณูููุฉ RBIA (rbiaplan) โ โ ุงูุฎุทุฉ ุงูุฌุฏูุฏุฉ
โโโ 1๏ธโฃ ุงูุชุฎุทูุท (planning)
โโโ 2๏ธโฃ ููู ุงูุนูููุฉ ูุงููุฎุงุทุฑ (processRisk)
โโโ 3๏ธโฃ ุจุฑูุงูุฌ ุงูุนูู ูุงูุนููุงุช (program)
โโโ 4๏ธโฃ ุงูุฃุนูุงู ุงูููุฏุงููุฉ ูุงูุฃุฏูุฉ (fieldwork)
โโโ 5๏ธโฃ ุงูููุณุงุช ุงูุฑุดููุฉ (agile)
โโโ 6๏ธโฃ ุงููุชุงุฆุฌ ูุงูุชูุตูุงุช (findings)
โโโ 7๏ธโฃ ุงูุชูุฑูุฑ ุงูููุงุฆู (reporting)
โโโ 8๏ธโฃ ุงููุชุงุจุนุฉ (followup)
โโโ 9๏ธโฃ ุงูุฅููุงู (closeout)
โโโ โ ุถูุงู ุงูุฌูุฏุฉ (qa)
```

**ุงููุชูุฌุฉ:** ุงููุงุฆูุฉ ุฃุตุจุญุช ุฃูุธู ููุง ุชุญุชูู ุนูู ุชูุฑุงุฑ!

---

## ๐ฏ **ููุงุฑูุฉ: ุงููุฏููุฉ vs ุงูุฌุฏูุฏุฉ**

| ุงูููุฒุฉ | Annualplan (ุงููุฏููุฉ) โ | rbiaplan (ุงูุฌุฏูุฏุฉ) โ |
|--------|--------------------------|------------------------|
| **ุงูุฌุฏูู** | ุจุณูุท | ูุชูุฏู ูุน ููุงุชุฑ ูุจุญุซ |
| **ุงูุจุทุงูุงุช** | ูุง ููุฌุฏ | 4 ุจุทุงูุงุช ููุฎุตุฉ |
| **CSV** | Import/Export ุฃุณุงุณู | Import/Export ูุชูุฏู |
| **RTL** | ุบูุฑ ูุชุณู | ูุงูู ููุชุณู |
| **i18n** | ุฌุฒุฆู | ูุงูู (AR/EN) |
| **Stepper** | ูุง ููุฌุฏ | 11 ุฎุทูุฉ ุฌุงูุจูุฉ |
| **LocalStorage** | ูุง ููุฌุฏ | ุญูุธ ุงูููุงุชุฑ ุชููุงุฆูุงู |
| **Performance** | ุนุงุฏู | useMemo optimization |
| **ARIA** | ูุง ููุฌุฏ | Full accessibility |
| **API Integration** | ูุญุฏูุฏ | 8 endpoints ูุงููุฉ |
| **Database Schema** | annual_plans | 8 ุฌุฏุงูู RBIA ูุชูุงููุฉ |

---

## ๐ **ุงูุฎุทุท ุงููุณุชูุจููุฉ**

### **ุงุฎุชูุงุฑู - ุญุฐู ุงููููุงุช ุงููุนููุฉ:**

ุฅุฐุง ุฃุฑุฏุช ุญุฐู ุงููููุงุช ุงููุนููุฉ ูู `features/annual-plan/`ุ ููููู ุชุดุบูู:

```powershell
# ุญุฐู ูุฌูุฏ ุงูุฎุทุฉ ุงููุฏููุฉ ุจุงููุงูู
Remove-Item -Path "d:\THE-AUDIT-APP-2\features\annual-plan" -Recurse -Force
```

**โ๏ธ ุชุญุฐูุฑ:** ูุฐุง ุงูุฃูุฑ ุณูุญุฐู ุงููููุงุช ููุงุฆูุงู. ุชุฃูุฏ ูู ุนูู backup ุฃููุงู!

---

### **ุงุฎุชูุงุฑู - ุชูุธูู i18n translations:**

ุญุงููุงูุ ุงูุชุฑุฌูุงุช ุงููุฏููุฉ ูู `annualPlan` ููุฌูุฏุฉ ูู `lib/i18n.ts` ููููุง ุบูุฑ ูุณุชุฎุฏูุฉ:

```typescript
// lib/i18n.ts - ุชุฑุฌูุงุช ุบูุฑ ูุณุชุฎุฏูุฉ (ุงุฎุชูุงุฑู ุญุฐููุง)
menu: {
  annualPlan: 'ุงูุฎุทุฉ ุงูุณูููุฉ',  // โ ุบูุฑ ูุณุชุฎุฏูุฉ
  // ...
}
sections: {
  annualPlan: 'ุงูุฎุทุฉ ุงูุณูููุฉ',  // โ ุบูุฑ ูุณุชุฎุฏูุฉ
  // ...
}
actions: {
  createAnnualPlan: 'ุฅูุดุงุก ุฎุทุฉ ุณูููุฉ',  // โ ุบูุฑ ูุณุชุฎุฏูุฉ
  addAuditTask: 'ุฅุถุงูุฉ ูููุฉ ุชุฏููู',      // โ ุบูุฑ ูุณุชุฎุฏูุฉ
  // ...
}
forms: {
  annualPlan: { ... }  // โ ูุงูู ุงููุณู ุบูุฑ ูุณุชุฎุฏู
}
```

**ููุงุญุธุฉ:** ุชูุฑูุช ุงูุชุฑุฌูุงุช ููุง ูู ูุฃููุง ูุง ุชุคุซุฑ ุนูู ุงูุฃุฏุงุก ููุง ุชุณุจุจ ุฃุฎุทุงุก.

---

## โ **ุงูุชุญูู ูู ุงูุนูู**

### **1. ุจูุงุก ุงููุดุฑูุน:**

```bash
pnpm dev
```

**ุงููุชูุฌุฉ:**
```
โ Ready in 2.8s
- Local: http://localhost:3001
```

โ **ูุง ุชูุฌุฏ ุฃุฎุทุงุก TypeScript**  
โ **ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงูุจูุงุก**  
โ **ุงูุณูุฑูุฑ ูุนูู ุจูุฌุงุญ**

---

### **2. ูุญุต Sidebar:**

```
ุฒูุงุฑุฉ: http://localhost:3001
โ ุชุณุฌูู ุงูุฏุฎูู
โ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ โ /shell
โ ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ุชุนุฑุถ:
   โ ููุญุฉ ุงูููุงุฏุฉ
   โ ุงูุฎุทุฉ ุงูุณูููุฉ RBIA (ุธุงูุฑุฉ ูุชุนูู)
   โ ุงูุฎุทุฉ ุงูุณูููุฉ ุงููุฏููุฉ (ูุญุฐููุฉ)
   โ 1) ุงูุชุฎุทูุท
   ... (ุจุงูู ุงูุฃูุณุงู)
```

---

### **3. ูุญุต Navigation:**

| ุงููุณุงุฑ | ุงูุญุงูุฉ | ุงููุชูุฌุฉ |
|--------|--------|---------|
| `/` | โ ูุนูู | Redirect ุฅูู /shell |
| `/shell` | โ ูุนูู | AppShell ูุน Dashboard |
| `/shell โ rbiaplan` | โ ูุนูู | RbiaPlanView ุชุธูุฑ |
| `/rbia/plan` | โ ูุนูู | Standalone page |
| `/shell โ annualPlan` | โ ูุญุฐูู | ูุง ูุธูุฑ ูู ุงููุงุฆูุฉ |

---

## ๐ **ุงูุฎูุงุตุฉ**

### **โ ุชู ุจูุฌุงุญ:**

1. โ ุญุฐู ุฌููุน ูุฑุงุฌุน `annualPlan` ูู AppShell
2. โ ุญุฐู Type, RBAC, TOOLBARS, MENU_SPEC entries
3. โ ุญุฐู Imports, State, Handlers, Modal
4. โ ุญุฐู Rendering case ูู Main section
5. โ ุงููุธุงู ูุนูู ุจุฏูู ุฃุฎุทุงุก
6. โ Sidebar ูุธูู ูููุธู
7. โ RBIA plan ูุนูู ุจุดูู ูุงูู

### **๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:**

- **ุงูุฎุทุฉ ุงููุฏููุฉ:** ูุญุฐููุฉ ุจุงููุงูู ูู UI โ
- **ุงูุฎุทุฉ ุงูุฌุฏูุฏุฉ RBIA:** ุชุนูู ุจุดูู ูุงูู ูุน ุฌููุน ุงูููุฒุงุช โ
- **ูุง ุชูุฌุฏ ุฃุฎุทุงุก:** TypeScript ุฃู Runtime โ
- **ุงููุธุงู ูุณุชูุฑ:** ุฌุงูุฒ ููุงุณุชุฎุฏุงู โ

---

## ๐ **ุงููููุงุช ุงูููุนุฏูุฉ**

| ุงูููู | ุงูุชุนุฏูู | ุงูุฃุณุทุฑ ุงููุญุฐููุฉ |
|------|---------|-----------------|
| `app/(app)/shell/AppShell.tsx` | ุญุฐู ุฌููุน ูุฑุงุฌุน annualPlan | ~60 ุณุทุฑ |

**ุฅุฌูุงูู ุงูุชุนุฏููุงุช:** 1 ููู  
**ุฅุฌูุงูู ุงูุญุฐู:** ~60 ุณุทุฑ

---

## ๐ก **ุชูุตูุงุช ุฅุถุงููุฉ**

### **1. ุญุฐู ุงููููุงุช ุงููุนููุฉ (ุงุฎุชูุงุฑู):**

```powershell
# ุฅุฐุง ููุช ูุชุฃูุฏุงู ุฃูู ูุง ุชุญุชุงุฌ ุงููููุงุช ุงููุฏููุฉ:
Remove-Item -Path "features\annual-plan" -Recurse -Force

# ุฃู ููููู ููููุง ุฅูู ูุฌูุฏ ุฃุฑุดูู:
Move-Item -Path "features\annual-plan" -Destination "archive\annual-plan-old"
```

### **2. ุชูุธูู i18n (ุงุฎุชูุงุฑู):**

ุญุฐู ุงูุชุฑุฌูุงุช ุบูุฑ ุงููุณุชุฎุฏูุฉ ูู `lib/i18n.ts`:
- `menu.annualPlan`
- `sections.annualPlan`
- `actions.createAnnualPlan`
- `actions.addAuditTask`
- `forms.annualPlan` (ูุงูู ุงููุณู)

### **3. ุชูุธูู Database (ุงุฎุชูุงุฑู):**

ุฅุฐุง ูุงู ูุฏูู ุจูุงูุงุช ูุฏููุฉ ูู ุฌุฏูู `annual_plans`:
```sql
-- ูุญุต ุงูุจูุงูุงุช ุงููุฏููุฉ
SELECT COUNT(*) FROM public.annual_plans;

-- ุญุฐู ุงูุจูุงูุงุช (ุฅุฐุง ูุฒู ุงูุฃูุฑ)
-- โ๏ธ ุชุญุฐูุฑ: ูุฐุง ุณูุญุฐู ุฌููุน ุงูุจูุงูุงุช ุงููุฏููุฉ
-- TRUNCATE TABLE public.annual_plans;
```

---

**โ ุงููููุฉ ููุชููุฉ ุจูุฌุงุญ!** ๐

ุงููุธุงู ุงูุขู ูุญุชูู ููุท ุนูู ุงูุฎุทุฉ ุงูุฌุฏูุฏุฉ RBIA ูุน ุฌููุน ุงูููุฒุงุช ุงููุชูุฏูุฉ!
